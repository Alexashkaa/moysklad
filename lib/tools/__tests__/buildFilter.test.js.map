{"version":3,"sources":["../../../src/tools/__tests__/buildFilter.test.js"],"names":["test","require","buildFilter","t","ok","equals","end","query","name","value","moment","Date","some","deepEqual","deep","tow","many","$eq","$gt","num","$gte","$lt","$lte","$ne","$exists","$in","notMany","$nin","$and","$not","throws","foo","undefined","Symbol","a"],"mappings":"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","file":"buildFilter.test.js","sourcesContent":["'use strict'\n\nconst test = require('blue-tape')\nconst buildFilter = require('../buildFilter')\n\ntest('buildFilter is ok', t => {\n  t.ok(buildFilter)\n  t.equals(typeof buildFilter, 'function')\n  t.end()\n})\n\ntest('buildFilter with simple filter', t => {\n  let query = {\n    name: 'foo',\n    value: 3,\n    moment: new Date(2017, 0, 10, 0, 15, 6, 556),\n    some: null\n  }\n\n  t.deepEqual(buildFilter(query),\n    'moment=2017-01-09 19:15:06;name=foo;some=;value=3')\n\n  t.end()\n})\n\ntest('buildFilter with simple deep and many condition filter', t => {\n  let query = {\n    name: 'foo',\n    value: 3,\n    moment: new Date(2017, 0, 10, 0, 15, 6, 556),\n    'deep.one': 5,\n    deep: {\n      tow: 'bar'\n    },\n    many: [1, 'baz']\n  }\n\n  t.deepEqual(buildFilter(query),\n    'deep.one=5;deep.tow=bar;many=1;many=baz;moment=2017-01-09 19:15:06;name=foo;value=3')\n\n  t.end()\n})\n\ntest('buildFilter with mogo query comparison selectors', t => {\n  let query = {\n    name: {\n      $eq: 'foo'\n    },\n    value: {\n      $gt: 5\n    },\n    num: {\n      $gte: 5, $lt: 10\n    },\n    moment: {\n      $lte: new Date(2017, 0, 10, 0, 15, 6, 556)\n    },\n    deep: {\n      tow: {\n        $ne: 'bar'\n      }\n    },\n    many: {\n      $exists: true,\n      $in: [1, 'baz']\n    },\n    notMany: {\n      $nin: [3, 6],\n      $gt: 5\n    }\n  }\n\n  t.deepEqual(buildFilter(query),\n    'deep.tow!=bar;many!=;many=1;many=baz;moment>=2017-01-09 19:15:06;name=foo;notMany!=3;' +\n    'notMany!=6;notMany>5;num<10;num>=5;value>5')\n\n  t.end()\n})\n\ntest('buildFilter with mogo query logical selectors', t => {\n  let query = {\n    name: {\n      $and: [\n        { $eq: 'foo' },\n        { $eq: 'bar' }\n      ]\n    },\n    value: {\n      $not: {\n        $eq: 10,\n        $in: [5, 6]\n      }\n    }\n  }\n\n  t.deepEqual(buildFilter(query),\n    'name=bar;name=foo;value!=10;value!=5;value!=6;value=')\n\n  t.end()\n})\n\ntest('buildFilter errors', t => {\n  t.throws(() => {\n    buildFilter()\n  }, 'filter must to be an object')\n\n  t.throws(() => {\n    buildFilter({ foo: undefined })\n  }, 'filter \"foo\" key value is undefined')\n\n  t.throws(() => {\n    buildFilter({ foo: Symbol('foo') })\n  }, 'filter \"foo\" key value is incorrect')\n\n  t.throws(() => {\n    buildFilter({ foo: { $eq: { a: 1 } } })\n  }, '$eq: value must to be string, number, date or null')\n\n  t.throws(() => {\n    buildFilter({ foo: { $in: { a: 1 } } })\n  }, '$in: selector value must to be an array')\n\n  t.throws(() => {\n    buildFilter({ foo: { $and: { a: 1 } } })\n  }, '$and: selector value must to be an array')\n\n  t.throws(() => {\n    buildFilter({ foo: { $not: 3 } })\n  }, '$not: selector value must to be an object')\n\n  t.throws(() => {\n    buildFilter({ foo: { $exists: 'boo' } })\n  }, '$exists: elector value must to be boolean')\n\n  t.end()\n})\n\n// debugger\n"]}